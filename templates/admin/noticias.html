
{% extends 'base.html' %}
{% block content %}
<h1>Noticias (Admin)</h1>
<form method="post" class="form">
  {{ form.csrf_token }}
  <label>Título {{ form.title(size=60) }}</label>
  <label>Contenido</label>
  <div id="editor" style="background:#fff;border:1px solid #cbd5e1; border-radius:12px;"></div>
  <textarea name="content" id="content" hidden></textarea>
  <label>Tipo {{ form.activity_type() }}</label>
  <button class="btn" onclick="beforeSubmit()">Publicar</button>
</form>
<h2>Publicadas</h2>
<ul class="list">
  {% for n in news %}
    <li>
      <strong>{{ n.title }}</strong> — {{ n.date.strftime('%d/%m/%Y') }} · {{ n.activity_type }}
      <form method="post" action="{{ url_for('admin.eliminar_noticia', news_id=n.id) }}" style="display:inline">
        <button class="btn danger">Eliminar</button>
      </form>
    </li>
  {% else %}
    <li>No hay noticias.</li>
  {% endfor %}
</ul>

<script src="https://cdn.quilljs.com/1.3.7/quill.js"></script>
<link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
<script>
  var quill = new Quill('#editor', { theme: 'snow' });
  function beforeSubmit(){
    var html = quill.root.innerHTML;
    document.getElementById('content').value = html;
    document.querySelector('form').submit();
  }
</script>
{% endblock %}
